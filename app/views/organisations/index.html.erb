<div class="box">
  <p class="center">Signed in as <%= current_user.name %></p>

  <h4 class="left-align">To get started you need to join or create an Organisation</h4>

  <h3 class="blue center">Organisations</h3>
  <ul class="left-align">
    <% @organisations.each do |item| %>
      <li><%= item.name %>
        <%= link_to 'Edit', edit_organisation_path(item) %>
        <% if current_user.joined_organisation?(item) %>
          <p>You are a member of this organisation</p>
        <% else %>
          <%= link_to 'Join', organisation_organisation_enrollments_path(item), method: :post %>
        <% end %>
      </li>
    <% end %>
  </ul>

  <h3 class="blue center">Create an Organisation</h3>
  <div class="left-align field">
    <%= simple_form_for @organisation do |f| %>
      <%= f.input :name, label: 'Name:', label_html: { class: 'form_field field' } %>
      <%= f.input :hourly_rate, label: 'Hourly Rate:', label_html: { class: 'form_field field' } %>
      <%= f.button :submit, class: 'field blue', style: 'margin-bottom: 15px;' %>
    <% end %>
  </div>
</div>

<script>
  function joinOrganisation(id) {
    console.log(id.inspect);
    return new Promise((resolve, reject) => {
      this.$http.put(`/organisations/3`, {
        organisation: {
          user_id: id
        }
      })
      .then((response) => {
        alert("Organisation Joined")
        });
        resolve(response);
      })
  }
</script>
